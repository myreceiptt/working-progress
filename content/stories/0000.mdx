---
title: "0101 init"
description: The manner in which initialization is performed depends on the type, storage class, etc., of an object to be initialized.
date: "2022-05-07"
url: https://objkt.com/tokens/KT18taVYgQ35rcuCca5QN7uq5EsFxKJyJvRT/0
published: true
repository: working-progress/blob/main/content/stories/0000.mdx
---

In computer programming, **initialization** (or **initialisation**) is the assignment of an initial value for a data object or variable. The manner in which initialization is performed depends on the programming language, as well as the type, storage class, etc., of an object to be initialized.

![](https://assets.objkt.media/file/assets-003/QmVs3kS4AqBGeu3ST5K2RRZMm6bitBLtqy1HaNVJyK6xvh/artifact)

So, 0101 init...  
...is the assignment of an initial value for all the next 1-on-1 artwork in this collection. What kind of 1-on-1 artwork will be presented in this collection? Shush, it's probably something, probably nothing, it depends on the algorithm of your brain, not Prof. NOTA's brain.

See you in the next drop!

## Built with

- Procreate hand drawings by [Retired Satan](https://objkt.com/@mrsatan).
- VisualVisual Studio Code description writing by Prof. NOTA.

```ts
import { Tinybird } from "@chronark/zod-bird";
import { z } from "zod";

const tb = new Tinybird({ token: "token" });

export const getEvents = tb.buildPipe({
  pipe: "get_events__v1",
  parameters: z.object({
    tenantId: z.string(),
  }),
  data: z.object({
    event: z.string(),
    time: z.number().transform((t) => new Date(t)),
  }),
});

const res = await getEvents({ tenantId: "chronark" })

// res.data = {event: string, time: Date}[]
```

## Install

```sh-session
npm i @chronark/zod-bird
```

## Ingesting Data

```ts
// lib/tinybird.ts
import { Tinybird } from "./client";
import { z } from "zod";

const tb = new Tinybird({ token: process.env.TINYBIRD_TOKEN! });

export const publishEvent = tb.buildIngestEndpoint({
  datasource: "events__v1",
  event: z.object({
    id: z.string(),
    tenantId: z.string(),
    channelId: z.string(),
    time: z.number().int(),
    event: z.string(),
    content: z.string().optional().default(""),
    metadata: z.string().optional().default(""),
  }),
});
```

```ts
// somewhere.ts
import { publishEvent } from "./lib/tinybird";

await publishEvent({
  id: "1",
  tenantId: "1",
  channelId: "1",
  time: Date.now(),
  event: "test",
  content: "test",
  metadata: JSON.stringify({ test: "test" }),
});
```

## Querying Endpoints

```ts
// lib/tinybird.ts
import { Tinybird } from "./client";
import { z } from "zod";

const tb = new Tinybird({ token: process.env.TINYBIRD_TOKEN! });

export const getChannelActivity = tb.buildPipe({
  pipe: "get_channel_activity__v1",
  parameters: z.object({
    tenantId: z.string(),
    channelId: z.string().optional(),
    start: z.number(),
    end: z.number().optional(),
    granularity: z.enum(["1m", "1h", "1d", "1w", "1M"]),
  }),
  data: z.object({
    time: z.string().transform((t) => new Date(t).getTime()),
    count: z
      .number()
      .nullable()
      .optional()
      .transform((v) => (typeof v === "number" ? v : 0)),
  }),
});
```

```ts
// somewhere.ts
import { getChannelActivity } from "./lib/tinybird";

const res = await getChannelActivity({
   tenantId: "1",
   channelId: "1",
   start: 123,
   end: 1234,
   granularity: "1h"
})

```
`res` is the response from the tinybird endpoint, but now fully typed and the data has been parsed according to the schema defined in `data`.

## Advanced

### Caching

You can add cache directives to each pipe.

#### Disable caching (useful in Next.js where everything is cached by default)

```ts
tb.buildPipe({
  pipe: "some_pipe__v1",
  parameters: z.object({
   hello: z.string()
  }),
  data: z.object({
    response: z.string()
  }),
   opts: {
      cache: "no-store" // <-------- Add this
   };
});
```

#### Cache for 15 minutes

```ts
tb.buildPipe({
  pipe: "some_pipe__v1",
  parameters: z.object({
   hello: z.string()
  }),
  data: z.object({
    response: z.string()
  }),
   opts: {
      revalidate: 900 ;// <-------- Add this
    };
});
```